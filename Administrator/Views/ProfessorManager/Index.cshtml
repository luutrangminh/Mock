@model IEnumerable<Administrator.Models.ProfessorViewModel>

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="row">
    <div class="col-lg-12">
        <h1 class="page-header">Professor Manager</h1>
    </div>
    <!-- /.col-lg-12 -->
</div>
<!-- /.row -->
<div class="row">
    <div class="col-lg-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                <button class="btn btn-primary btn-sm" id="btnAddNew">Create New</button>
            </div>
            <!-- /.panel-heading -->
            <div class="panel-body">
                <table width="100%" class="table table-striped table-bordered table-hover" id="dataTables-example">
                    <thead>
                        <tr>
                            <th>
                                @Html.DisplayNameFor(model => model.fullName)
                            </th>
                            <th>
                                @Html.DisplayNameFor(model => model.email)
                            </th>
                            <th>
                                @Html.DisplayNameFor(model => model.username)
                            </th>
                            <th>
                                @Html.DisplayNameFor(model => model.password)
                            </th>
                            <th>
                                @Html.DisplayNameFor(model => model.phoneNumber)
                            </th>
                            <th>
                                @Html.DisplayNameFor(model => model.address)
                            </th>
                            <th>
                                @Html.DisplayNameFor(model => model.createdAt)
                            </th>
                            <th>
                                @Html.DisplayNameFor(model => model.createdByStr)
                            </th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model)
                        {
                            <tr class="gradeA">
                                <td>
                                    @Html.DisplayFor(modelItem => item.fullName)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => item.email)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => item.username)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => item.password)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => item.phoneNumber)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => item.address)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => item.createdAt)
                                </td>
                                <td>
                                    @Html.DisplayFor(modelItem => item.createdByStr)
                                </td>
                                <td>
                                    @Html.ActionLink("Edit", "Edit", new { id = item.id }) |
                                    @Html.ActionLink("Delete", "Delete", new { id = item.id, fullName = item.fullName })
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
            <!-- /.panel-body -->
        </div>
        <!-- /.panel -->
    </div>
    <!-- /.col-lg-12 -->
</div>


<!-- Modal -->
<div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog">

        <!-- Modal content-->

        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Create New Professor</h4>
            </div>
            <div class="modal-body">
                @RenderPage("CreateNew.cshtml")
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="btnSave">Add New</button>
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<script>
    //Add new
    $("#btnAddNew").click(function () {
        $("#myModal").modal('show');
        $("#error-txtFullName").html("");
        $("#error-txtEmail").html("");
        $("#error-txtUserName").html("");
        $("#error-txtPassword").html("");
        $("#error-txtPasswordConfirm").html("");
        $("#error-txtPhoneNumber").html("");
        $("#error-txtAddress").html("");
    });

    $("#btnSave").click(function () {

        let professor = {
            fullName: $("#txtFullName").val(),
            email: $("#txtEmail").val(),
            userName: $("#txtUserName").val(),
            password: $("#txtPassword").val(),
            passwordConfirm: $("#txtPasswordConfirm").val(),
            phoneNumber: $("#txtPhoneNumber").val(),
            address: $("#txtAddress").val()
        };
        $.post("/admin/ProfessorManager/CreateNew", {
            fullName: professor.fullName,
            email: professor.email,
            userName: professor.userName,
            password: professor.password,
            passwordConfirm: professor.passwordConfirm,
            phoneNumber: professor.phoneNumber,
            address: professor.address
        }, function (response) {
            if (response.Status) {
                console.log("Tạo mới thành công");
                location.reload();

            } else {
                $("#error-txtFullName").html(response.Errors.fullName[0]);
                $("#error-txtEmail").html(response.Errors.email[0]);
                $("#error-txtUserName").html(response.Errors.userName[0]);
                $("#error-txtPassword").html(response.Errors.password[0]);
                $("#error-txtPasswordConfirm").html(response.Errors.passwordConfirm[0]);
                $("#error-txtPhoneNumber").html(response.Errors.phoneNumber[0]);
                $("#error-txtAddress").html(response.Errors.address[0]);
            }
        });

    });

</script>